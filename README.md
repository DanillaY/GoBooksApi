# GoBooksApi

----
## Содержание

### Что такое GoBooksApi?
**GoBooksApi** - это api, который позволяет получить доступ к информации в базе данных в формате json.Api Использует GoScrapper для сбора информации на сайтах:

<ol>
	<li>https://book24.ru/</li>
	<li>https://vse-svobodny.com/</li>
	<li>https://www.chitai-gorod.ru/</li>
</ol>

Данные о книгах собираются с целью проведения анализа цен в различных цифровых магазинах.

### Как использовать Api?

Для использования api потребуется:

1. Для клонирования проекта с подмодулем требуется написать команду:
	```shell
	git clone https://github.com/DanillaY/GoBooksApi --recurse-submodules
	```
2. Для создания и запуска docker контейнеров требуется написать:
    ```shell
	docker compose up --build
	```
После запуска приложения контейнер GoScrapper начнет собирать данные о книгах в базу данных с выводом соответствующих логов.

Для того, чтобы узнать на каком ip открылись docker контейнеры нужно прописать команду `ipconfig` для windows и `ip addr show` для linux, обычно docker контейнеры начинаются с 172. По умолчанию api будет слушать на 8089 порте, чтобы его поменять потребуется отредактировать файл [dbDokcer.env](./dbDocker.env). 

#### Api Route

GoBooksApi содержит путь /getBooks, данные из которого можно фильтровать с помощью query запросов.

Стандартный запрос на полчуние книг без дополнительных параметров выведет 30 случайных записей из базы данных.

Пример стандартного запроса getBooks: <http://172.21.80.1:8089/getBooks>


#### Модель book json

В ответ на запрос сервер должен отправить указаное колличество моделей book (Если колличество не было указано, то будет отправлено 30 моделей)
**Важно отметить, что не все поля могут быть заполнены!**

Пример одной модели book:

```json
{
        "ID": 2759,
        "CurrentPrice": 239,
        "OldPrice": 289,
        "Title": "Посторонний",
        "ImgPath": "https://content.img-gorod.ru/nomenclature/28/597/2859722-1.jpg?width=310&height=500&fit=bounds",
        "PageBookPath": "https://www.chitai-gorod.ru/product/postoronniy-2859722",
        "Vendor": "https://www.chitai-gorod.ru",
        "Author": "Альбер Камю",
        "Translator": "",
        "ProductionSeries": "Эксклюзивная классика",
        "Category": "",
        "Publisher": "Neoclassic",
        "ISBN": "978-5-17-137323-8",
        "AgeRestriction": "16+",
        "YearPublish": "2021",
        "PagesQuantity": "128",
        "BookCover": "Мягкий",
        "Format": "18x11.5x1",
        "Weight": "109",
        "BookAbout": "«Посторонний» — дебютная работа молодого писателя, своеобразный творческий манифест. Понятие абсолютной свободы — основной постулат этого манифеста. Героя этой повести судят за убийство, которое он совершил по самой глупой из всех возможных причин. И это правда, которую герой не боится бросить в лицо своим судьям, пойти наперекор всему, забыть обо всех условностях и умереть во имя своих убеждений."
    },
```

#### Возможные query параметры для фильтрации

Чтобы легко фильтровать записи из базы данных GoBooksApi принимает различные параметры, которые ограничивают область видимости базы, такие как:

- category - отвечает за категорию книги 
- author - отвечает за автора книги
- title - отвечает за название книги
- minPrice, maxPrice - отвечает за минимальную и максимальную цену книги, данные параметры чаще всего используются вместе для определения ограничений цены, но также они могут использоваться и отдельно, **важно заметить, что данные параметры сравниваются с текущей ценой (current_price), а не с ценой без скидки (old_price)**
- limit - ограничение колличества отправляемых моделей book, если требуется убрать ограничение в 30 моделей, то следует отправить запрос с limit равным -1, и тогда будут выведены все имеющиеся книги по данному запросу

Пример запроса с применением различных query параметров: <http://172.21.80.1:8089/getBooks?limit=3&author=ницше&title=воля&maxPrice=220>

Также query параметры в GoBooksApi не является регистрозависимыми, это означает, что ответ сервера при запросе <http://172.21.80.1:8089/getBooks?author=Гоголь> не будет отличаться от запроса <http://172.21.80.1:8089/getBooks?author=гОгоЛь>